/* tooltipster-follower v0.1.0 */!function(a,b){"function"==typeof define&&define.amd?define(["tooltipster"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("tooltipster")):b(jQuery)}(this,function(a){return a.tooltipster.plugin({name:"laa.follower",instance:{_defaults:function(){return{anchor:"top-left",maxWidth:null,minWidth:0,offset:[15,-15]}},_init:function(a){var b=this;b.pointerPosition,b.helper,b.initialROS=a.option("repositionOnScroll"),b.instance=a,b.latestMousemove,b.namespace=b.instance.namespace+"-follower",b.options,b.previousState="closed",b.size,b.initialROS||b.instance.option("repositionOnScroll",!0),b._optionsFormat(),b.instance._on("destroyed."+b.namespace,function(){b._destroy()}),b.instance._on("options."+b.namespace,function(){b._optionsFormat()}),b.instance._on("reposition."+b.namespace,function(a){b._reposition(a.event,a.helper)}),b.instance._on("start."+b.namespace,function(a){b.instance.$origin.on("mousemove."+b.namespace,function(a){b.latestMousemove=a})}),b.instance._one("startend."+b.namespace+" startcancel."+b.namespace,function(a){b.instance.$origin.off("mousemove."+b.namespace),"startcancel"==a.type&&(b.latestMousemove=null)}),b.instance._on("state."+b.namespace,function(a){"closed"==a.state?b._close():"appearing"==a.state&&"closed"==b.previousState&&b._create(),b.previousState=a.state})},_close:function(){"object"==typeof this.instance.Content&&null!==this.instance.Content&&this.instance.Content.detach(),this.instance.$tooltip.remove(),this.instance.$tooltip=null,a(a.tooltipster.env.window.document).off("."+this.namespace)},_create:function(){var b=this,c=a('<div class="tooltipster-base tooltipster-follower"><div class="tooltipster-box"><div class="tooltipster-content"></div></div></div>');b.options.minWidth&&c.css("min-width",b.options.minWidth+"px"),b.options.maxWidth&&c.css("max-width",b.options.maxWidth+"px"),b.instance.$tooltip=c,a(a.tooltipster.env.window.document).on("mousemove."+b.namespace,function(a){b._follow(a)}),b.instance._trigger("created")},_destroy:function(){this.instance.off("."+this.namespace),this.initialROS||this.instance.option("repositionOnScroll",!1)},_follow:function(b){this.latestMousemove&&(b=this.latestMousemove,this.latestMousemove=null);var c={},d=this.options.anchor,e=a.merge([],this.options.offset);switch(d){case"top-left":case"left-center":case"bottom-left":c.left=b.pageX+e[0];break;case"top-center":case"bottom-center":c.left=b.pageX+e[0]-this.size.width/2;break;case"top-right":case"right-center":case"bottom-right":c.left=b.pageX+e[0]-this.size.width;break;default:console.log("Wrong anchor value")}switch(d){case"top-left":case"top-center":case"top-right":c.top=b.pageY-e[1];break;case"left-center":case"right-center":c.top=b.pageY-e[1]-this.size.height/2;break;case"bottom-left":case"bottom-center":case"bottom-right":c.top=b.pageY-e[1]-this.size.height}if("left-center"==d||"right-center"==d){if("right-center"==d)c.left<this.helper.geo.window.scroll.left&&(b.pageX-e[0]+this.size.width<=this.helper.geo.window.scroll.left+this.helper.geo.window.size.width?(d="left-center",e[0]=-e[0],c.left=b.pageX+e[0]):(d="top-right",e[1]=e[0],c={left:0,top:b.pageY-e[1]}));else if(c.left+this.size.width>this.helper.geo.window.scroll.left+this.helper.geo.window.size.width){var f=b.pageX-e[0]-this.size.width;f>=0?(d="right-center",e[0]=-e[0],c.left=f):(d="top-left",e[1]=-e[0],c={left:b.pageX+e[0],top:b.pageY-e[1]})}c.top+this.size.height>this.helper.geo.window.scroll.top+this.helper.geo.window.size.height&&(c.top=this.helper.geo.window.scroll.top+this.helper.geo.window.size.height-this.size.height),c.top<this.helper.geo.window.scroll.top&&(c.top=this.helper.geo.window.scroll.top),c.top+this.size.height>this.helper.geo.document.size.height&&(c.top=this.helper.geo.document.size.height-this.size.height),c.top<0&&(c.top=0)}if("left-center"!=d&&"right-center"!=d){c.left+this.size.width>this.helper.geo.window.scroll.left+this.helper.geo.window.size.width&&(c.left=this.helper.geo.window.scroll.left+this.helper.geo.window.size.width-this.size.width),c.left<0&&(c.left=0);var g=b.pageY-this.helper.geo.window.scroll.top;if(0==d.indexOf("bottom"))c.top<this.helper.geo.window.scroll.top&&(c.top<0||g<this.helper.geo.window.size.height-g&&b.pageY+e[1]+this.size.height<=this.helper.geo.document.size.height)&&(c.top=b.pageY+e[1]);else{var h=c.top+this.size.height;if(h>this.helper.geo.window.scroll.top+this.helper.geo.window.size.height&&(g>this.helper.geo.window.size.height-g||g-e[1]+this.size.height<=this.helper.geo.document.size.height)){var i=b.pageY+e[1]-this.size.height;i>=0&&(c.top=i)}}}this.helper.geo.origin.fixedLineage&&(c.left-=this.helper.geo.window.scroll.left,c.top-=this.helper.geo.window.scroll.top),this.instance.$tooltip.css({left:c.left,top:c.top}),this.instance._trigger({coord:c,event:b,type:"followed"})},_optionsFormat:function(){var b=this._defaults(),c=this.instance.options[this.name]||this.instance.options;this.options=a.extend(!0,{},b,c)},_reposition:function(b,c){var d=this,e=d.instance.$tooltip.clone(),f=a.tooltipster._getRuler(e),g=f.free().measure();f.destroy(),d.size=g.size,d.helper=c,c.geo.origin.fixedLineage?d.instance.$tooltip.css("position","fixed"):d.instance.$tooltip.css("position",""),d.instance.$tooltip.css({height:d.size.height,width:d.size.width}),b&&d._follow(b),d.instance.$tooltip.appendTo(d.instance.options.parent),d.instance._trigger({type:"repositioned",event:b,position:{coord:{left:0,top:0},size:d.size}})}}}),a});